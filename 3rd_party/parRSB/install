#!/bin/bash
set -e

VER=0.9.2

if [ "$1" == "clean" ]; then
  rm -rf parRSB_v$VER/build lib include 2>/dev/null
  exit 0
fi

if [ -f ./lib/libparRSB.a ]; then
  exit 0
fi

if [ ! -d ./parRSB_v$VER ]; then
  rm -rf ./parRSB* 2>/dev/null #delete any version that might already exist
  wget --no-check-certificate -O v$VER.tar.gz https://github.com/Nek5000/parRSB/archive/v$VER.tar.gz
  mkdir parRSB_v$VER
  tar -zxvf v$VER.tar.gz -C ./parRSB_v$VER --strip-components=1
fi

cd parRSB_v$VER
set -x
make lib install $PARRSB_OPT
set +x
